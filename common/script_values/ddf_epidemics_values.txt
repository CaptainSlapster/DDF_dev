######################
# Epidemics
######################

#### OUTBREAK CHANCE ###
# Chance for an outbreak of this intensity to spawn on a province per year
# % from 0-100 inclusive
# root = potential province

### CONTROL VALUES ###
# These should be enough to change the balance of epidemics 

# Outbreak

outbreak_chance_base_extra_low = 0.00035 #0005
outbreak_chance_base_very_low = 0.00082 #001
outbreak_chance_base_low = 0.0090 #01
outbreak_chance_base_medium = 0.008 #02
outbreak_chance_base_high = 0.035 #04
outbreak_chance_base_very_high = 0.09 #12

outbreak_increase_add_extra_low = 0.002
outbreak_increase_add_low = 0.003 #0.004
outbreak_increase_add_medium = 0.0045 #0.008
outbreak_increase_add_high = 0.011  #0.016
outbreak_increase_add_very_high = 0.023 #0.032
outbreak_increase_add_extra_high = 0.030 #0.064

outbreak_decrease_add_low = -0.003
outbreak_decrease_add_medium = -0.008
outbreak_decrease_add_high = -0.016
outbreak_decrease_add_very_high = -0.032
outbreak_decrease_add_unlikely = -0.064

outbreak_increase_mult_low = 0.1
outbreak_increase_mult_medium = 0.15
outbreak_increase_mult_high = 0.35
outbreak_increase_mult_very_high = 0.6

outbreak_decrease_mult_very_low = -0.04
outbreak_decrease_mult_low = -0.1
outbreak_decrease_mult_medium = -0.30
outbreak_decrease_mult_high = -0.6
outbreak_decrease_mult_very_high = -0.8
outbreak_decrease_mult_unlikely = -0.995

# Spread


spread_chance_base_low = 3 # 3.5
spread_chance_base_medium = 6 # 5
spread_chance_base_high = 10 # 9

spread_increase_add_low = 2 # 2
spread_increase_add_medium = 3 # 3
spread_increase_add_high = 4 # 4

spread_decrease_add_low = -0.3 # 0.4
spread_decrease_add_medium = -0.6
spread_decrease_add_high = -1.5
spread_decrease_add_very_high = -2.3

spread_increase_mult_low = 0.25 #0.25
spread_increase_mult_medium = 0.75 #0.75
spread_increase_mult_high = 1.05 # 1
spread_increase_mult_very_high = 1.25 # 1.75

spread_decrease_mult_low = -0.22
spread_decrease_mult_medium = -0.4
spread_decrease_mult_high = -0.6
spread_decrease_mult_unlikely = -0.87


##DDF Added Epidemic Values##
#
#MATH FOR THE GAMERULES :/
#
####
#Vanilla
smallpox_min_infection_minor_base = 8
smallpox_max_infection_minor_base = 10
smallpox_min_infection_major_base = 12
smallpox_max_infection_major_base = 24
smallpox_min_infection_apocalyptic_base = 22
smallpox_max_infection_apocalyptic_base = 40

typhus_min_infection_minor_base = 8
typhus_max_infection_minor_base = 16
typhus_min_infection_major_base = 12
typhus_max_infection_major_base = 24
typhus_min_infection_apocalyptic_base = 24
typhus_max_infection_apocalyptic_base = 48

consumption_min_infection_minor_base = 14
consumption_max_infection_minor_base = 22
consumption_min_infection_major_base = 22
consumption_max_infection_major_base = 35
consumption_min_infection_apocalyptic_base = 35
consumption_max_infection_apocalyptic_base = 50

measles_min_infection_minor_base = 7
measles_max_infection_minor_base = 12
measles_min_infection_major_base = 8
measles_max_infection_major_base = 16
measles_min_infection_apocalyptic_base = 12
measles_max_infection_apocalyptic_base = 24

dysentery_min_infection_minor_base = 4
dysentery_max_infection_minor_base = 8
dysentery_min_infection_major_base = 9
dysentery_max_infection_major_base = 18
dysentery_min_infection_apocalyptic_base = 16
dysentery_max_infection_apocalyptic_base = 32

ergotism_min_infection_minor_base = 8
ergotism_max_infection_minor_base = 16
ergotism_min_infection_major_base = 12
ergotism_max_infection_major_base = 18
ergotism_min_infection_apocalyptic_base = 24
ergotism_max_infection_apocalyptic_base = 30

bubonic_plague_min_infection_minor_base = 6
bubonic_plague_max_infection_minor_base = 12
bubonic_plague_min_infection_major_base = 12
bubonic_plague_max_infection_major_base = 24
bubonic_plague_min_infection_apocalyptic_base = 24
bubonic_plague_max_infection_apocalyptic_base = 48



##DDF
malaria_min_infection_minor_base = 6
malaria_max_infection_minor_base = 13
malaria_min_infection_major_base = 8
malaria_max_infection_major_base = 16
malaria_min_infection_apocalyptic_base = 10
malaria_max_infection_apocalyptic_base = 15

typhoid_min_infection_minor_base = 8
typhoid_max_infection_minor_base = 12
typhoid_min_infection_major_base = 12
typhoid_max_infection_major_base = 24
typhoid_min_infection_apocalyptic_base = 22
typhoid_max_infection_apocalyptic_base = 40

flu_min_infection_minor_base = 9
flu_max_infection_minor_base = 13
flu_min_infection_major_base = 13
flu_max_infection_major_base = 16
flu_min_infection_apocalyptic_base = 20
flu_max_infection_apocalyptic_base = 35

min_infection_duration_multi = 0.2

max_infection_duration_multi = 0.4

smallpox_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = smallpox_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = smallpox_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = smallpox_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = smallpox_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = smallpox_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = smallpox_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
smallpox_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = smallpox_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = smallpox_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = smallpox_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = smallpox_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = smallpox_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = smallpox_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}

typhus_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = typhus_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = typhus_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = typhus_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = typhus_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = typhus_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = typhus_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
typhus_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = typhus_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = typhus_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = typhus_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = typhus_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = typhus_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = typhus_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}

consumption_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = consumption_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = consumption_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = consumption_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = consumption_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = consumption_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = consumption_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
consumption_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = consumption_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = consumption_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = consumption_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = consumption_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = consumption_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = consumption_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}

measles_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = measles_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = measles_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = measles_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = measles_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = measles_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = measles_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
measles_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = measles_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = measles_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = measles_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = measles_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = measles_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = measles_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}

dysentery_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = dysentery_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = dysentery_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = dysentery_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = dysentery_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = dysentery_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = dysentery_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
dysentery_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = dysentery_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = dysentery_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = dysentery_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = dysentery_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = dysentery_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = dysentery_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}


ergotism_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = ergotism_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = ergotism_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = ergotism_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = ergotism_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = ergotism_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = ergotism_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
ergotism_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = ergotism_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = ergotism_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = ergotism_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = ergotism_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = ergotism_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = ergotism_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}

malaria_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = malaria_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = malaria_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = malaria_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = malaria_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = malaria_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = malaria_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
malaria_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = malaria_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = malaria_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = malaria_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = malaria_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = malaria_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = malaria_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}

typhoid_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = typhoid_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = typhoid_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = typhoid_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = typhoid_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = typhoid_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = typhoid_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
typhoid_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = typhoid_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = typhoid_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = typhoid_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = typhoid_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = typhoid_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = typhoid_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}

flu_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = flu_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = flu_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = flu_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = flu_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = flu_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = flu_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
flu_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = flu_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = flu_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = flu_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = flu_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = flu_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = flu_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}

#Bubonic will be special because of the extra gamerule#
bubonic_plague_min_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = bubonic_plague_min_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = bubonic_plague_min_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = bubonic_plague_min_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#else_if = { #Disabled for RN
	#	limit = {
	#		#This is the eternal black death. Honestly the math will make it last at minimum 2400 years so kinda eternal yea.
	#		has_game_rule = eternal_black_death
	#	}
	#	multiply = 100
	#}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = bubonic_plague_min_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = bubonic_plague_min_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = bubonic_plague_min_infection_apocalyptic_base
		}
	}

	#Finally round up or down
	round = yes
}
bubonic_plague_max_infection_duration = {
	##Setup values#
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = minor
			}
		}
		value = bubonic_plague_max_infection_minor_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		value = bubonic_plague_max_infection_major_base
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		value = bubonic_plague_max_infection_apocalyptic_base
	}

	#Do the math#
	if = {
		limit = {
			has_game_rule = increased_plague_duration
		}
		multiply = min_infection_duration_multi	
	}
	else_if = {
		limit = {
			has_game_rule = extreme_plague_duration
		}
		multiply = max_infection_duration_multi
	}
	#else_if = { Disabled for RN
	#	limit = {
	#		#This is the eternal black death. Honestly the math will make it last at minimum 2400 years so kinda eternal yea.
	#		has_game_rule = eternal_black_death
	#	}
	#	multiply = 100
	#}
	#Then add the appropriate value#
	add = {
		if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = minor
				}
			}
			value = bubonic_plague_max_infection_minor_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = major
				}
			}
			value = bubonic_plague_max_infection_major_base
		}
		else_if = {
			limit = {
				scope:epidemic = {
					outbreak_intensity = apocalyptic
				}
			}
			value = bubonic_plague_max_infection_apocalyptic_base
		}
	}
	
	#Finally round up or down
	round = yes
}



outbreak_chance_minor_default_value = {
	value = outbreak_chance_base_low
	#Buildings
	if = {
		limit = {
			num_buildings >= 4
		}
		add = {
			value = num_buildings
			multiply = outbreak_increase_add_low
		}
	}

	
	if = {
		limit = {
			epidemic_resistance < 9
		}
		add = outbreak_decrease_mult_very_low
	}
	else_if = {
		limit = {
			epidemic_resistance > 10
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			epidemic_resistance > 20
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			epidemic_resistance > 30
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			epidemic_resistance > 40
		}
		add = spread_decrease_mult_medium
	}
	else_if = {
		limit = {
			epidemic_resistance > 50
		}
		add = spread_decrease_mult_medium
	}
	else_if = {
		limit = {
			epidemic_resistance > 60
		}
		add = spread_decrease_mult_medium
	}
	else_if = {
		limit = {
			epidemic_resistance > 70
		}
		add = spread_decrease_mult_high
	}
	else_if = {
		limit = {
			epidemic_resistance > 80
		}
		add = spread_decrease_mult_high
	}
	else_if = {
		limit = {
			epidemic_resistance > 90
		}
		add = spread_decrease_mult_high
	}


	##DDF additions##
	#City holdings slightly increase outbreak risks 
	if = {
		limit = {
			has_building_or_higher = city_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_02
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = city_03
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = city_04
		}
		add = outbreak_increase_add_high
	}



	#City Markets 
	if = {
		limit = {
			has_building_or_higher = city_market_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_market_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_market_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_market_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = city_market_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = city_market_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = city_market_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = city_market_08
		}
		add = outbreak_increase_add_high
	}
	#Estates 
	if = {
		limit = {
			has_building_or_higher = farm_estates_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_08
		}
		add = outbreak_increase_add_high
	}

	#Barracks 
	if = {
		limit = {
			has_building_or_higher = barracks_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = barracks_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = barracks_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = barracks_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = barracks_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = barracks_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = barracks_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = barracks_08
		}
		add = outbreak_increase_add_high
	}

		
	


	##Vanilla##
	#Tradeports
	if = {
		limit = {
			has_building_or_higher = common_tradeport_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_08
		}
		add = outbreak_increase_add_high
	}

	#Markets
	if = {
		limit = {
			has_building_or_higher = market_villages_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = market_villages_02
		}
		add = outbreak_increase_add_low
	}

	#Guild Halls
	if = {
		limit = {
			has_building_or_higher = guild_halls_01
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_04
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_08
		}
		add = outbreak_increase_add_high
	}

	if = {
		limit = {
			OR = {
				has_global_variable = is_in_tutorial
				AND = {
					has_global_variable = start_epidemic_grace
					OR = {
						county.holder = { is_ai = no }
						county.holder = {
							any_liege_or_above = { is_ai = no }
						}
					}
				}
			}
		}
		multiply = 0
	}
}

outbreak_chance_minor_mult_value = {
	value = 1

	# Game rules
	if = {
		limit = {
			has_game_rule = epidemic_frequency_often
		}
		add = outbreak_increase_mult_low
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_often
		}
		add = outbreak_increase_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_doomsday
		}
		add = outbreak_increase_mult_high
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_rare
		}
		add = outbreak_decrease_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_rare
		}
		add = outbreak_decrease_mult_high
	}

	##DDF Gamerules 
	# They stack with vanilla stuff
	#
	if = {
		limit = {
			has_game_rule = normal_plague_frequency
		}
		add = 0 # It's normal game frequency
	}
	else_if = {
		limit = {
			has_game_rule = extra_plague_frequency
		}
		add = outbreak_increase_mult_medium # Extra	
	}
	else_if = {
		limit = {
			has_game_rule = super_plague_frequency
		}
		add = outbreak_increase_mult_high #super
	}
	#Development
	add = {
		value = county.development_level
		multiply = 0.002
	}

	#Era pacing
	if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_late_medieval
			}
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_high_medieval
			}
		}
		add = 0
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_early_medieval
			}
		}
		add = 0
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_tribal
			}
		}
		add = outbreak_decrease_mult_low
	}

	#Terrain
	if = {
		limit = {
			OR = {
				terrain = hills
				terrain = forest
				terrain = desert
				terrain = desert_mountains
				terrain = mountains
			}
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			OR = {
				terrain = jungle
				terrain = taiga
			}
		}
		add = outbreak_increase_mult_low
	}

	#Developed places
	if = {
		limit = {
			has_holding = yes
		}
		add = outbreak_increase_mult_low
	}
	if = {
		limit = {
			has_holding_type = city_holding
		}
		add = outbreak_increase_mult_low
	}
	if = {
		limit = {
			OR = {
				has_holding_type = herder_holding
				has_holding_type = nomad_holding
			}
		}
		add = outbreak_decrease_mult_high
	}	
	multiply = 0.8
	min = 0.001
}

outbreak_chance_major_default_value = {
	value = outbreak_chance_base_very_low 

	#Buildings
	if = {
		limit = {
			num_buildings >= 6
		}
		add = {
			value = num_buildings
			multiply = outbreak_increase_add_low
		}
	}

	##DDF additions##
	#City Markets 
	if = {
		limit = {
			has_building_or_higher = city_market_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_market_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_market_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_market_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = city_market_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = city_market_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = city_market_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = city_market_08
		}
		add = outbreak_increase_add_high
	}
	#Estates 
	if = {
		limit = {
			has_building_or_higher = farm_estates_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_08
		}
		add = outbreak_increase_add_high
	}

	#Barracks 
	if = {
		limit = {
			has_building_or_higher = barracks_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = barracks_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = barracks_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = barracks_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = barracks_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = barracks_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = barracks_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = barracks_08
		}
		add = outbreak_increase_add_high
	}


	#Tradeports
	if = {
		limit = {
			has_building_or_higher = common_tradeport_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_02
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_06
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_07
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_08
		}
		add = outbreak_increase_add_medium
	}

	#Markets
	if = {
		limit = {
			has_building_or_higher = market_villages_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = market_villages_02
		}
		add = outbreak_increase_add_low
	}

	#Guild Halls
	if = {
		limit = {
			has_building_or_higher = guild_halls_01
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_02
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_03
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_04
		}
		add = outbreak_increase_add_medium
	}

	if = {
		limit = {
			OR = {
				has_global_variable = is_in_tutorial
				AND = {
					has_global_variable = start_epidemic_grace
					OR = {
						county.holder = { is_ai = no }
						county.holder = {
							any_liege_or_above = { is_ai = no }
						}
					}
				}
			}
		}
		multiply = 0
	}
}

outbreak_chance_major_mult_value = {
	value = 0.8

	# Game rules
	if = {
		limit = {
			has_game_rule = epidemic_frequency_often
		}
		add = outbreak_increase_mult_low
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_often
		}
		add = outbreak_increase_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_doomsday
		}
		add = outbreak_increase_mult_high
	}
	else_if = {
		limit = {
			OR = {
				has_game_rule = epidemic_frequency_rare
				has_game_rule = easy_difficulty
			}
		}
		add = outbreak_decrease_mult_medium
	}
	else_if = {
		limit = {
			OR = {
				has_game_rule = epidemic_frequency_very_rare
				has_game_rule = very_easy_difficulty
			}
		}
		add = outbreak_decrease_mult_high
	}
	##DDF Gamerules 
	# They stack with vanilla stuff
	#
	if = {
		limit = {
			has_game_rule = normal_plague_frequency
		}
		add = 0 # It's normal game frequency
	}
	else_if = {
		limit = {
			has_game_rule = extra_plague_frequency
		}
		add = outbreak_increase_mult_medium # Extra	
	}
	else_if = {
		limit = {
			has_game_rule = super_plague_frequency
		}
		add = outbreak_increase_mult_high #super
	}
	#Development
	add = {
		value = county.development_level
		multiply = 0.008
	}

	#Era pacing
	if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_late_medieval
			}
		}
		add = 0
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_high_medieval
			}
		}
		add = 0
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_early_medieval
			}
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_tribal
			}
		}
		add = outbreak_decrease_mult_medium
	}

	#Terrain
	if = {
		limit = {
			OR = {
				terrain = hills
				terrain = forest
				terrain = desert
				terrain = desert_mountains
				terrain = mountains
			}
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			OR = {
				terrain = jungle
				terrain = taiga
			}
		}
		add = outbreak_increase_mult_low
	}

	#Developed places
	if = {
		limit = {
			has_holding = yes
		}
		add = outbreak_increase_mult_low
	}
	if = {
		limit = {
			has_holding_type = city_holding
		}
		add = outbreak_increase_mult_low
	}
	if = {
		limit = {
			OR = {
				has_holding_type = herder_holding
				has_holding_type = nomad_holding
			}
		}
		add = outbreak_decrease_mult_high
	}	
	multiply = 1.05
	
	min = 0.001
}

outbreak_chance_apocalyptic_default_value = {
	value = outbreak_chance_base_extra_low
	
	#Buildings
	if = {
		limit = {
			num_buildings >= 10
		}
		add = {
			value = num_buildings
			multiply = outbreak_increase_add_low
		}
	}

	##DDF additions##
	#City Markets 
	if = {
		limit = {
			has_building_or_higher = city_market_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_market_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_market_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = city_market_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = city_market_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = city_market_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = city_market_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = city_market_08
		}
		add = outbreak_increase_add_high
	}
	#Estates 
	if = {
		limit = {
			has_building_or_higher = farm_estates_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = farm_estates_08
		}
		add = outbreak_increase_add_high
	}

	#Barracks 
	if = {
		limit = {
			has_building_or_higher = barracks_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = barracks_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = barracks_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = barracks_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = barracks_05
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = barracks_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = barracks_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = barracks_08
		}
		add = outbreak_increase_add_high
	}


	#Tradeports
	if = {
		limit = {
			has_building_or_higher = common_tradeport_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_04
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_05
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_06
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_07
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_08
		}
		add = outbreak_increase_add_medium
	}

	#Markets
	if = {
		limit = {
			has_building_or_higher = market_villages_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = market_villages_02
		}
		add = outbreak_increase_add_low
	}

	#Guild Halls
	if = {
		limit = {
			has_building_or_higher = guild_halls_01
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_02
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_03
		}
		add = outbreak_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_04
		}
		add = outbreak_increase_add_low
	}

	if = {
		limit = {
			OR = {
				has_global_variable = is_in_tutorial
				AND = {
					has_global_variable = start_epidemic_grace
					OR = {
						county.holder = { is_ai = no }
						county.holder = {
							any_liege_or_above = { is_ai = no }
						}
					}
				}
			}
		}
		multiply = 0
	}
}

outbreak_chance_apocalyptic_mult_value = {
	value = 0.5

	# Game rules
	if = {
		limit = {
			has_game_rule = epidemic_frequency_often
		}
		add = outbreak_increase_mult_low
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_often
		}
		add = outbreak_increase_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_doomsday
		}
		add = outbreak_increase_mult_high
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_rare
		}
		add = outbreak_decrease_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_rare
		}
		add = outbreak_decrease_mult_high
	}
	##DDF Gamerules 
	# They stack with vanilla stuff
	#
	if = {
		limit = {
			has_game_rule = normal_plague_frequency
		}
		add = 0 # It's normal game frequency
	}
	else_if = {
		limit = {
			has_game_rule = extra_plague_frequency
		}
		add = outbreak_increase_mult_medium # Extra	
	}
	else_if = {
		limit = {
			has_game_rule = super_plague_frequency
		}
		add = outbreak_increase_mult_high #super
	}
	#Development
	add = {
		value = county.development_level
		#nerfed a bit
		multiply = 0.006
		
	}

	#Era pacing
	if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_late_medieval
			}
		}
		add = 0
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_high_medieval
			}
		}
		add = outbreak_decrease_mult_medium
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_early_medieval
			}
		}
		add = outbreak_decrease_mult_unlikely
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_tribal
			}
		}
		add = outbreak_decrease_mult_unlikely
	}

	#Terrain
	if = {
		limit = {
			OR = {
				terrain = hills
				terrain = forest
				terrain = desert
				terrain = desert_mountains
				terrain = mountains
			}
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			OR = {
				terrain = jungle
				terrain = taiga
			}
		}
		add = outbreak_increase_mult_low
	}

	#Developed places
	if = {
		limit = {
			has_holding = yes
		}
		add = outbreak_increase_mult_low
	}
	if = {
		limit = {
			has_holding_type = city_holding
		}
		add = outbreak_increase_mult_low
	}
	
	multiply = 1.05
	
	min = 0.0005
}


outbreak_chance_dysentery_default_value = {

	value = outbreak_chance_base_low #Shouldn't happen unless there's an army present	
	if = {
		limit = {
			any_army_in_location ?= {
				OR = {
					is_army_in_combat = yes
					is_army_in_raid = yes
				}
			}
		}
		add = outbreak_increase_add_extra_high
	}
	if = {
		limit = {
			any_army_in_location ?= {
				count >= 1
			}
		}
		add = outbreak_increase_add_very_high

	}
	if = {
		limit = {
			any_army_in_location ?= {
				is_army_in_siege = yes
			}
		}
		add = outbreak_increase_add_extra_high
		if = {
			limit = {
				fort_level >= 12
			}
			add = outbreak_increase_add_very_high
		}
		if = {
			limit = {
				fort_level >= 10
			}
			add = outbreak_increase_add_high
		}
		if = {
			limit = {
				fort_level >= 8
			}
			add = outbreak_increase_add_high
		}
		if = {
			limit = {
				fort_level >= 4
			}
			add = outbreak_increase_add_medium
		}
		if = {
			limit = {
				fort_level > 2
			}
			add = outbreak_increase_add_low
		}
	}

	if = {
		limit = {
			OR = {
				has_global_variable = is_in_tutorial
				AND = {
					has_global_variable = start_epidemic_grace
					OR = {
						county.holder = { is_ai = no }
						county.holder = {
							any_liege_or_above = { is_ai = no }
						}
					}
				}
			}
		}
		multiply = 0
	}
}

outbreak_chance_dysentery_mult_value = {
	value = 1
	min = 0.001
	# Game rules
	if = {
		limit = {
			has_game_rule = epidemic_frequency_often
		}
		add = outbreak_increase_mult_low
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_often
		}
		add = outbreak_increase_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_doomsday
		}
		add = outbreak_increase_mult_high
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_rare
		}
		add = outbreak_decrease_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_rare
		}
		add = outbreak_decrease_mult_high
	}
	##DDF Gamerules 
	# They stack with vanilla stuff
	#
	if = {
		limit = {
			has_game_rule = normal_plague_frequency
		}
		add = 0 # It's normal game frequency
	}
	else_if = {
		limit = {
			has_game_rule = extra_plague_frequency
		}
		add = outbreak_increase_mult_medium # Extra	
	}
	else_if = {
		limit = {
			has_game_rule = super_plague_frequency
		}
		add = outbreak_increase_mult_high #super
	}
	#Era pacing
	if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_late_medieval
			}
		}
		add = 0
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_high_medieval
			}
		}
		add = 0
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_early_medieval
			}
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_tribal
			}
		}
		add = outbreak_decrease_mult_medium
	}

	#Terrain
	if = {
		limit = {
			OR = {
				terrain = hills
				terrain = forest
				terrain = desert
				terrain = desert_mountains
				terrain = mountains
			}
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			OR = {
				terrain = jungle
				terrain = taiga
			}
		}
		add = outbreak_increase_mult_low
	}

	#Developed places
	if = {
		limit = {
			has_holding = yes
		}
		add = outbreak_increase_mult_low
	}
	if = {
		limit = {
			has_holding_type = city_holding
		}
		add = outbreak_increase_mult_low
	}
}

outbreak_chance_black_plague_default_value = {
	value = outbreak_chance_base_extra_low

	#Disabled for rn 
	#if = {
	#	limit = {
	#		has_game_rule = eternal_black_death
	#	}
	#	add = 1000 # Basically should start the game with it.
	#}
	#else_if = {
	#	limit = {
	#		has_game_rule = normal_black_death
	#	}
	#	add = 0 # doesn't add anything so vanilla :)
	#}
	#Buildings
	if = {
		limit = {
			num_buildings >= 20
		}
		add = {
			value = num_buildings
			multiply = outbreak_increase_add_medium
		}
	}

	if = {
		limit = {
			has_building_or_higher = common_tradeport_03
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_04
		}
		add = outbreak_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_05
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_06
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_07
		}
		add = outbreak_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_08
		}
		add = outbreak_increase_add_high
	}
	
	if = {
		limit = {
			has_game_rule = epidemic_frequency_disabled
		}
		multiply = 0
	}

	if = {
		limit = {
			has_game_rule = bd_occurrence_random
		}
		add = outbreak_increase_add_high
	}

	if = {
		limit = {
			OR = {
				has_global_variable = is_in_tutorial
				AND = {
					has_global_variable = start_epidemic_grace
					OR = {
						county.holder = { is_ai = no }
						county.holder = {
							any_liege_or_above = { is_ai = no }
						}
					}
				}
			}
		}
		multiply = 0
	}
}

outbreak_chance_black_plague_mult_value = {
	value = 1
	min = 0.001
	#Development
	add = {
		value = county.development_level
		multiply = 0.08
	}

	# Game rules
	if = {
		limit = {
			has_game_rule = epidemic_frequency_often
		}
		add = outbreak_increase_mult_low
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_often
		}
		add = outbreak_increase_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_doomsday
		}
		add = outbreak_increase_mult_high
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_rare
		}
		add = outbreak_decrease_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_rare
		}
		add = outbreak_decrease_mult_high
	}
	##DDF Gamerules 
	# They stack with vanilla stuff
	#
	if = {
		limit = {
			has_game_rule = normal_plague_frequency
		}
		add = 0 # It's normal game frequency
	}
	else_if = {
		limit = {
			has_game_rule = extra_plague_frequency
		}
		add = outbreak_increase_mult_medium # Extra	
	}
	else_if = {
		limit = {
			has_game_rule = super_plague_frequency
		}
		add = outbreak_increase_mult_high #super
	}
	#Era pacing
	if = {
		limit = {
			NOR = {
				has_game_rule = bd_occurrence_random
				has_game_rule = bd_frequency_unlimited
			}
		}
		if = {
			limit = {
				culture = {
					has_cultural_era_or_later = culture_era_late_medieval
				}
			}
			add = outbreak_decrease_mult_low
		}
		else_if = {
			limit = {
				culture = {
					has_cultural_era_or_later = culture_era_high_medieval
				}
			}
			add = outbreak_decrease_mult_medium
		}
		else_if = {
			limit = {
				culture = {
					has_cultural_era_or_later = culture_era_early_medieval
				}
			}
			add = outbreak_decrease_mult_high
		}
		else_if = {
			limit = {
				culture = {
					has_cultural_era_or_later = culture_era_tribal
				}
			}
			add = outbreak_decrease_mult_unlikely
		}
	}

	#Terrain
	if = {
		limit = {
			OR = {
				terrain = hills
				terrain = forest
				terrain = desert
				terrain = desert_mountains
				terrain = mountains
			}
		}
		add = outbreak_decrease_mult_low
	}
	else_if = {
		limit = {
			OR = {
				terrain = jungle
				terrain = taiga
			}
		}
		add = outbreak_increase_mult_low
	}

	#Developed places
	if = {
		limit = {
			has_holding = yes
		}
		add = outbreak_increase_mult_low
	}
	if = {
		limit = {
			has_holding_type = city_holding
		}
		add = outbreak_increase_mult_low
	}
}

#### SPREAD CHANCE ###
#Controls the spread of the epidemic
#root = potential_province

spread_chance_epidemics_default_value = {
	if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		add = spread_chance_base_high
	}
	else_if = {
		limit = {
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		add = spread_chance_base_medium
	}
	else = { #minor
		add = spread_chance_base_low
	}
	
	#less patchy, add
	if = {
		limit = {
			county = {
				any_county_province = {
					any_province_epidemic = {
						this.epidemic_type = scope:epidemic.epidemic_type
					}
				}
			}
		}
		add = spread_increase_add_high
	}

	#Dysentery spreads to armies and forts
	if = {
		limit = { scope:epidemic.epidemic_type = epidemic_type:dysentery }
		add = {
			if = {
				limit = {
					any_army_in_location ?= {
						is_army_in_siege = yes
					}
				}
				add = spread_increase_add_high
			}
			if = {
				limit = {
					any_army_in_location ?= {
						OR = {
							is_army_in_combat = yes
							is_army_in_raid = yes
						}
					}
				}
				add = spread_increase_add_medium
			}
			if = {
				limit = {
					any_army_in_location ?= {
						count >= 1
					}
				}
				add = spread_increase_add_high
			}			
		}
		add = {
			value = fort_level
			multiply = spread_increase_mult_low
		}
	}
	
	#Buildings
	add = {
		value = num_buildings
		multiply = spread_increase_mult_low
	}

	#Tradeports
	if = {
		limit = {
			has_building_or_higher = common_tradeport_01
		}
		add = spread_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_02
		}
		add = spread_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_03
		}
		add = spread_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_04
		}
		add = spread_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_05
		}
		add = spread_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_06
		}
		add = spread_increase_add_medium
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_07
		}
		add = spread_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = common_tradeport_08
		}
		add = spread_increase_add_high
	}

	#Markets
	if = {
		limit = {
			has_building_or_higher = market_villages_01
		}
		add = spread_increase_add_low
	}
	if = {
		limit = {
			has_building_or_higher = market_villages_02
		}
		add = spread_increase_add_low
	}

	#Guild Halls
	if = {
		limit = {
			has_building_or_higher = guild_halls_02
		}
		add = spread_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_04
		}
		add = spread_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_06
		}
		add = spread_increase_add_high
	}
	if = {
		limit = {
			has_building_or_higher = guild_halls_08
		}
		add = spread_increase_add_high
	}


	#Terrain
	if = {
		limit = {
			terrain = farmlands
		}
		add = spread_increase_add_medium
	}
	else_if = {
		limit = {
			OR = {
				terrain = floodplains
				terrain = wetlands
			}
		}
		add = spread_increase_add_low
	}
	else_if = {
		limit = {
			OR = {
				terrain = plains
				terrain = steppe
			}
		}
		add = spread_increase_add_low
	}
	else_if = {
		limit = {
			OR = {
				terrain = hills
				terrain = drylands
				terrain = oasis
				terrain = forest
			}
		}
		add = spread_decrease_add_low
	}
	else_if = {
		limit = {
			OR = {
				terrain = jungle
				terrain = taiga
			}
		}
		add = spread_decrease_add_medium
	}
	else_if = {
		limit = {
			OR = {
				terrain = desert
				terrain = desert_mountains
				terrain = mountains
			}
		}
		add = spread_decrease_add_medium
	}
	#Island?
	if = {
		limit = {
			geographical_region = divergence_island_regions
		}
		add = spread_decrease_add_medium
	}
	#Cultural Traditions
	if = {
		limit = {
			county.culture = {
				OR = {
					has_cultural_tradition = tradition_city_keepers
					has_cultural_tradition = tradition_maritime_mercantilism
				}
			}
		}
		add = spread_increase_add_medium
	}
	else_if = {
		limit = {
			county.culture = {
				OR = {
					has_cultural_tradition = tradition_esteemed_hospitality
					has_cultural_tradition = tradition_horse_lords
					has_cultural_tradition = tradition_caravaneers
					has_cultural_tradition = tradition_seafaring
				}
			}
		}
		add = spread_increase_add_low
	}
	else_if = {
		limit = {
			county.culture = {
				OR = {
					has_cultural_tradition = tradition_practiced_pirates
					has_cultural_tradition = tradition_parochialism
				}
			}
		}
		add = spread_increase_add_low
	}
	if = {
		limit = {
			county.culture = {
				has_cultural_tradition = tradition_hidden_cities
			}
		}
		add = spread_decrease_add_high
	}
	else_if = {
		limit = {
			county.culture = {
				has_cultural_parameter = less_plague_spread_culture
			}
		}
		add = spread_decrease_add_high
	}
	
	#Reinfection shouldn't happen often
	if = {
		limit = {
			scope:epidemic = {
				is_target_in_variable_list = {
					name = epidemic_cooldown
				}
			}
		}
		add = spread_decrease_add_very_high
	}
}

spread_chance_epidemics_mult_value  = {
	value = 1
	min = 0.001

		#calc the resistance
	multiply = {
		value = title_province.epidemic_resistance
		multiply = 0.75
	}


	#Coastal Statistics Squash
	if = {
		limit = {
			OR = {
				is_coastal = yes
				is_riverside_province = yes
			}
			NOR = {
				has_building_or_higher = common_tradeport_04
				num_buildings > 4
			}
		}
		add = spread_decrease_mult_medium
	}

	#Making sure that England gets properly rekted by the Black Plague
	if = {
		limit = {
			has_global_variable = black_death
			scope:epidemic = global_var:black_death
			OR = {
				is_coastal = yes
				is_riverside_province = yes
			}
			has_building_or_higher = common_tradeport_06
			num_buildings > 10
		}
		add = spread_increase_mult_very_high
	}

	#less patchy, mult
	if = {
		limit = {
			county = {
				any_county_province = {
					any_province_epidemic = {
						this.epidemic_type = scope:epidemic.epidemic_type
					}
				}
			}
		}
		add = spread_increase_mult_very_high
	}

	#Development
	add = {
		value = county.development_level
		#Decreased Slightly from 0.025#
		multiply = 0.015
		#This way some plague resist can help with the dev issue#
		multiply = {
			value = title_province.epidemic_resistance 
			divide = 2
			multiply = 0.005
		}
	}


	# Game rules
	if = {
		limit = {
			has_game_rule = epidemic_frequency_doomsday
		}
		add = spread_increase_mult_very_high
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_often
		}
		add = spread_increase_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_often
		}
		add = spread_increase_mult_low
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_very_rare
		}
		add = spread_decrease_mult_medium
	}
	else_if = {
		limit = {
			has_game_rule = epidemic_frequency_rare
		}
		add = spread_decrease_mult_low
	}

	#Intensity mult

	if = {
		limit = { 
			scope:epidemic = {
				outbreak_intensity = apocalyptic
			}
		}
		add = spread_increase_mult_high
	}
	else_if = {
		limit = { 
			scope:epidemic = {
				outbreak_intensity = major
			}
		}
		add = spread_increase_mult_medium
	}

	#Recent Epidemics
	if = {
		limit = {
			is_target_in_variable_list = {
				name = epidemic_cooldown #Average lifespan
				target = scope:epidemic.epidemic_type
			}
		}
		if = {
			limit = {
				has_game_rule = epidemic_frequency_often
			}
			add = spread_decrease_mult_high
		}
		else_if = {
			limit = {
				has_game_rule = epidemic_frequency_very_often
			}
			add = spread_decrease_mult_medium
		}
		else_if = {
			limit = {
				has_game_rule = epidemic_frequency_doomsday
			}
			add = spread_decrease_mult_low
		}
		else = {
			add = spread_decrease_mult_unlikely
		}	
	}

	#People still remember how to social distance in general
	if = {
		limit = {
			has_variable = epidemic_cooldown_general #Average social memory
		}
		if = {
			limit = {
				has_game_rule = epidemic_frequency_very_often
			}
			add = spread_decrease_mult_medium
		}
		else_if = {
			limit = {
				has_game_rule = epidemic_frequency_doomsday
			}
			add = spread_decrease_mult_low
		}
		else = {
			add = spread_decrease_mult_high
		}
	}

	#Developed places
	if = {
		limit = {
			has_holding = yes
		}
		add = spread_increase_mult_low
	}
	if = {
		limit = {
			OR = {
				has_holding_type = castle_holding
				has_holding_type = church_holding
			}
		}
		add = spread_increase_mult_low
	}
	if = {
		limit = {
			has_holding_type = city_holding
		}
		add = spread_increase_mult_medium
	}
	if = {
		limit = {
			OR = {
				has_holding_type = herder_holding
				has_holding_type = nomad_holding
			}
		}
		add = outbreak_decrease_mult_unlikely
	}
}

#### DAILY INFECTION RATE ###
#The velocity at which the infection rate goes up in a province

infection_rate_change_value = {
	
}

#### CHARACTER INFECTION CHANCE ###
#Monthly chance for an epidemic to infect a character in the province

would_follow_social_distancing_value = {
	value = -1 #let's assume medieval people wouldn't by default
	if = {
		limit = { has_perk = wash_your_hands_perk }
		add = 5 # was 10
	}
	if = {
		limit = { has_trait = shy }
		add = 1
	}
	if = {
		limit = { has_trait = paranoid }
		add = 2
	}
	if = {
		limit = { has_trait = reclusive }
		add = 4
	}
	if = {
		limit = { has_trait = shrewd }
		add = 1
	}
	if = {
		limit = { has_trait = lifestyle_physician }
		add = 4
	}
	if = {
		limit = { has_trait = lifestyle_herbalist }
		add = 2
	}
	if = {
		limit = { has_trait = diligent }
		add = 1
	}
	if = {
		limit = { has_trait = craven }
		add = 1
	}
	if = {
		limit = { has_trait = temperate }
		add = 1
	}
	if = {
		limit = { has_trait = arbitrary }
		add = -1
	}
	if = {
		limit = { has_trait = brave }
		add = -1
	}
	if = {
		limit = { has_trait = impatient }
		add = -2
	}
	if = {
		limit = { has_trait = gregarious }
		add = -4
	}
	if = {
		limit = { has_trait = dull }
		add = -2
	}
	#Would your culture be touchy?/take this seriously
	if = {
		limit = { culture = { has_cultural_tradition = tradition_fp2_ritualised_friendship } }
		add = -1
	}
	if = {
		limit = { culture = { has_cultural_tradition = tradition_life_is_just_a_joke } }
		add = -1
	}
	if = {
		limit = { culture = { has_cultural_parameter = better_disease_resistance } }
		add = 10 # was 20
	}
}


##INCREASING THIS TO MAKE DISEASE A BIT MORE IMPACTFUL##
character_infection_chance_default_value = {
	value = 20
	#If you're already sick/weak you're screwed
	if = { 
		limit = { 
			OR = {
				has_trait = sickly
				has_trait = weak
				has_trait = inbred
				health <= poor_health
			}
		}
		add = 45
	}
	if = {
		limit = {
			has_character_modifier = ddf_coughing_fit
		}
		add = 10
	}
	if = {
		limit = {
			has_character_modifier = ddf_pus_boils
		}
		add = 45
	}
	#Epidemic Intensity
	if = {
		limit = {
			scope:epidemic ?= {
				outbreak_intensity = apocalyptic
				epidemic_type.epidemic_trait = trait:bubonic_plague
			}
		}
		add = 45
	}
	else_if = {
		limit = {
			scope:epidemic ?= {
				outbreak_intensity = apocalyptic
				NOT = { epidemic_type.epidemic_trait = trait:bubonic_plague }
			}
		}
		add = 35
	}
	else_if = {
		limit = {
			scope:epidemic ?= {
				outbreak_intensity = major
			}
		}
		add = 35 #25
	}
	else = { #minor
		add = 25 #15
	}
	#Let's see if you have any advantageous traits/perks / Wash your hands is included in the social distancing calculation, these are purely health related
	if = {
		limit = {
			has_trait = athletic
		}
		add = -4
	}
	if = {
		limit = {
			has_perk = iron_constitution_perk
		}
		add = -6
	}
	if = {
		limit = {
			has_perk = healthy_perk
		}
		add = -8
	}
	if = {
		limit = {
			has_trait = whole_of_body
		}
		add = -10
	}
	#Things to bump the numbers
	if = {
		limit = {
			is_foreign_court_or_pool_guest = yes
		}
		add = 40
	}
	if = {
		limit = {
			is_ruler = no
		}
		add = 10
	}
	#Children getting hit with measles
	if = {
		limit = {
			scope:epidemic.epidemic_type.epidemic_trait = trait:measles
			is_adult = no
		}
		add = 20
	}
	#"Old" people get hit more in general
	if = {
		limit = {
			age >= 65
		}
		add = 45
	}
	else_if = {
		limit = {
			age >= 50
		}
		add = 30
	}
	else_if = {
		limit = {
			age >= 40
		}
		add = 25
	}
	else_if = {
		limit = {
			age >= 30
		}
		add = 15
	}

	#children/babies have weaker immune systems
	else_if = {
		limit = {
			age <= 15
		}
		add = 10
	}
	else_if = {
		limit = {
			age <= 5
		}
		add = 25
	}

	# Camp resistance.
	if = {
		limit = {
			host.domicile ?= { has_domicile_parameter = camp_infection_chance_buff_1 }
		}
		# Max buff.
		if = {
			limit = {
				host.domicile ?= { has_domicile_parameter = camp_infection_chance_buff_6 }
			}
			add = -40
		}
		# Very high buff.
		else_if = {
			limit = {
				host.domicile ?= { has_domicile_parameter = camp_infection_chance_buff_5 }
			}
			add = -30
		}
		# High buff.
		else_if = {
			limit = {
				host.domicile ?= { has_domicile_parameter = camp_infection_chance_buff_4 }
			}
			add = -25
		}
		# Medium buff.
		else_if = {
			limit = {
				host.domicile ?= { has_domicile_parameter = camp_infection_chance_buff_3 }
			}
			add = -20
		}
		# Small buff.
		else_if = {
			limit = {
				host.domicile ?= { has_domicile_parameter = camp_infection_chance_buff_2 }
			}
			add = -15
		}
		# Slight buff.
		else_if = {
			limit = {
				host.domicile ?= { has_domicile_parameter = camp_infection_chance_buff_1 }
			}
			add = -10
		}
	}
	#Would you follow social distancing?
	#your numerical social distance value gets transformed here into a bonus/malus
	add = {
		value = would_follow_social_distancing_value
		multiply = -1 #inverted value
	}
	#How infected is your location?
	#Follows the infection rate thresholds set for the barony/county modifiers
	#
	# Anything less than 10 won't help much
	#
	if = {
		limit = {
			location = { epidemic_resistance > 90 }
		}
		multiply = 0.15
	}
	else_if = {
		limit = {
			location = { epidemic_resistance > 75 }
		}
		multiply = 0.25
	}
	else_if = {
		limit = {
			location = { epidemic_resistance > 50 }
		}
		multiply = 0.5
	}
	else_if = {
		limit = {
			location = { epidemic_resistance > 10 }
		}
		multiply = 0.75
	}
	else_if = {
		limit = {
			location = { epidemic_resistance < 10 }
		}
		multiply = 0.85
	}
	#Vaccination#
	if = {
		limit = {
			has_character_modifier = ddf_variolation
		}
		multiply = 0.15 #85 less likely :)
	}
	#Are you taking proper measures?
	if = {
		limit = {
			has_character_modifier = isolating_modifier
		}
		multiply = 0.25 #75% less likely
	}
	#How infected is your location?
	#Follows the infection rate thresholds set for the barony/county modifiers
	if = {
		limit = {
			scope:province = { epidemic_resistance > 90 }
		}
		multiply = 0.15
	}
	else_if = {
		limit = {
			scope:province = { epidemic_resistance > 75 }
		}
		multiply = 0.25
	}
	else_if = {
		limit = {
			scope:province = { epidemic_resistance > 50 }
		}
		multiply = 0.5
	}
	else_if = {
		limit = {
			scope:province = { epidemic_resistance > 10 }
		}
		multiply = 0.75
	}
	else_if = {
		limit = {
			scope:province = { epidemic_resistance < 10 }
		}
		multiply = 0.85
	}
	min = 1 # Never totally immune
}

#How contagious is this character?
character_contagious_value = {
	add = { #would they follow social distancing?
		value = would_follow_social_distancing_value
		multiply = -1 #inverted
	}
	if = {
		limit = {
			has_trait = wheezing
		}
		add = 4
	}
	##Diseases can increase the spread rate##
	##Boils on smallpox & bubonic can burst##
	if = {
		limit = {
			has_trait = smallpox
		}
		add = 20
	}
	if = {
		limit = {
			has_trait = typhoid
		}
		add = 10
	}
	if = {
		limit = {
			has_trait = diphtheria
		}
		add = 10
	}
	if = {
		limit = {
			has_trait = measles
		}
		add = 10
	}
	
	if = {
		limit = {
			has_trait = bubonic_plague
		}
		add = 25
	}
	#coughing can make you spread diseases
	if = {
		limit = {
			has_character_modifier = ddf_coughing_fit
		}
		add = 10
	}
		#coughing can make you spread diseases
	if = {
		limit = {
			has_character_modifier = ddf_pus_boils
		}
		add = 10
	}
	
		#A vaccine will help with herd immunity
	if = {
		limit = {
			has_character_modifier = ddf_variolation
		}
		add = -45
	}
}

recent_epidemics_outbreak_mult_value = {
	value = 1
	min = 0.001
	#Recently recovered from this epidemic
	if = {
		limit = {
			is_target_in_variable_list = {
				name = epidemic_cooldown #Average lifespan
				target = scope:epidemic_type
			}
		}
		if = {
			limit = {
				has_game_rule = epidemic_frequency_very_often
			}
			value = outbreak_decrease_mult_high
		}
		else_if = {
			limit = {
				has_game_rule = epidemic_frequency_doomsday
			}
			value = outbreak_decrease_mult_medium
		}
		else = {
			value = outbreak_decrease_mult_unlikely
		}
		
	}

	#People still remember how to social distance in general
	else_if = {
		limit = {
			has_variable = epidemic_cooldown_general #Average social memory
		}
		if = {
			limit = {
				has_game_rule = epidemic_frequency_very_often
			}
			value = outbreak_decrease_mult_medium
		}
		else_if = {
			limit = {
				has_game_rule = epidemic_frequency_doomsday
			}
			value = outbreak_decrease_mult_low
		}
		else = {
			value = outbreak_decrease_mult_high
		}
	}
}

#How badly effected is a county's development?
epidemic_development_loss_value = {
	subtract = scope:base_loss

	#This feeds into the change_development_progress in 00_epidemics
	#Bear in mind that minimal_development_progress_loss is 10
	#and massive_development_progress_loss is 100
	#Aim for something between those two extremes generally (in minus)

	#Since we have widespread development loss handled by modifier, we
	#now use this figure to 'chunk' down places with very high development
	#so they are disproportionately affected

	scope:epidemic = {
		switch = {
			trigger = outbreak_intensity
			minor = { subtract = 3.5 }
			major = { subtract = 6.5 }
			apocalyptic = { subtract = 8.5 }
		}
	}

	# Development
	subtract = {
		value = development_level
		multiply = 0.35
	}

	multiply = {
		value = 6
		divide = num_county_holdings
	}

	multiply = {
		value = 100
		subtract = title_province.epidemic_resistance
		multiply = 0.005
		add = 1
	}
}
#How badly effected is a county's fertility?
epidemic_fertility_loss_value = {
	subtract = scope:base_loss

	scope:epidemic = {
		switch = {
			trigger = outbreak_intensity
			minor = { subtract = 2.5 }
			major = { subtract = 5 }
			apocalyptic = { subtract = 7.5 }
		}
	}

	# Fertility
	subtract = {
		value = county_fertility
		multiply = 0.3
	}

	multiply = {
		value = 6
		divide = num_county_holdings
	}

	multiply = {
		value = 50
		subtract = title_province.epidemic_resistance
		multiply = 0.005
		add = 1
	}
}
epidemic_fromdust_value = {
	value = minor_gold_value
	multiply = former_infected_county_count
}

former_infected_county_count = {
	value = 1
	every_in_list = {
		variable = formerly_infected_counties
		add = 0.1
	}
}

